<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ 'Doctor View | ' + user.name if doctor_view else 'My Health Records' }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="layout-wrapper">
        <aside class="sidebar">
             <header class="sidebar-header">MediChain</header>
            <nav>
                <!-- The sidebar is different for a doctor vs a patient -->
                {% if doctor_view %}
                <a href="#" class="active">Patient Records</a>
                {% else %}
                <a href="{{ url_for('dashboard') }}">Home</a>
                <a href="{{ url_for('records') }}" class="active">Records</a>
                <a href="#">Appointments</a>
                <a href="#">Messages</a>
                {% endif %}
            </nav>
            
            <!-- The logout button only shows for logged-in patients -->
            {% if not doctor_view %}
            <div class="sidebar-footer">
                <a href="{{ url_for('logout') }}" class="logout-btn">Logout</a>
            </div>
            {% endif %}
        </aside>

        <main class="main-content">
            <header class="records-header">
                <!-- The title changes based on who is viewing -->
                <h1>{{ 'Records for: ' + user.name if doctor_view else 'My Health Records' }}</h1>
                
                <!-- The upload button ONLY appears for doctors -->
                {% if doctor_view %}
                <a href="{{ url_for('upload_page', patient_id=patient_id) }}" class="btn btn-primary">Upload New Record</a>
                {% endif %}
            </header>

            <!-- This records list is styled the same for both views -->
            <div class="records-list">
                {% for record in records %}
                <a href="{{ url_for('record_detail', record_id=record.id) }}" class="record-item">
                    <div class="record-icon">ðŸ“„</div>
                    <div class="record-info">
                        <strong>{{ record.file_name }}</strong>
                        <span>{{ record.classification | default('PDF', true) | upper }}</span>
                    </div>
                    <div class="record-date">{{ record.uploaded_at.split('T')[0] }}</div>
                </a>
                {% else %}
                <div class="record-item" style="display: block; text-align: center; padding: 2rem;">
                    <p>No records found for this patient.</p>
                </div>
                {% endfor %}
            </div>
        </main>
    </div>
</body>
</html>
