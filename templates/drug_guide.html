<!-- REPLACE THE ENTIRE CONTENT OF templates/drug_guide.html WITH THIS BLOCK -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Drug Guide - MediChain</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
</head>
<body>
    <div class="layout-wrapper">
        <!-- The Full Sidebar -->
        <aside class="sidebar">
            <header class="sidebar-header">MediChain</header>
            <nav>
                <a href="{{ url_for('dashboard') }}"><i data-feather="home"></i> Home</a>
                <a href="{{ url_for('records') }}"><i data-feather="file-text"></i> Records</a>
                <a href="{{ url_for('drug_guide') }}" class="active"><i data-feather="book-open"></i> Drug Guide</a>
            </nav>
            <div class="sidebar-footer">
                <a href="{{ url_for('logout') }}" class="logout-btn"><i data-feather="log-out"></i> Logout</a>
            </div>
        </aside>

        <main class="main-content">
            <header class="main-header">
                <h1>Drug Guide</h1>
            </header>
            
            <!-- THIS IS THE RESTORED SEARCH BAR SECTION -->
            <div class="search-container">
                <form method="GET" action="{{ url_for('drug_guide') }}" class="search-form">
                    <div class="search-wrapper">
                        <i class="search-icon" data-feather="search"></i>
                        <input type="search" name="q" placeholder="Search by trade or scientific name..." value="{{ search_query or '' }}" autocomplete="off">
                        <button type="submit" style="display: none;">Search</button>
                    </div>
                </form>
            </div>

            <!-- This is the List/Grid View Switcher -->
            <div class="view-switcher">
                <button id="list-view-btn" class="view-btn active"><i data-feather="list"></i></button>
                <button id="grid-view-btn" class="view-btn"><i data-feather="grid"></i></button>
            </div>

            <!-- This is the Drug List display -->
            <div class="drug-list" id="drug-list-container">
                {% for drug in drugs %}
                <a href="{{ url_for('drug_detail', drug_id=drug.id) }}" class="drug-item">
                    <img src="{{ drug.image_url or 'https://via.placeholder.com/50' }}" alt="{{ drug.trade_name }}">
                    <div class="drug-info">
                        <strong>{{ drug.trade_name }}</strong>
                        <span>{{ drug.scientific_name }}</span>
                    </div>
                </a>
                {% else %}
                <div class="no-drugs-found">
                    <p>No drugs found matching your search.</p>
                </div>
                {% endfor %}
            </div>
        </main>
    </div>

    <!-- All necessary scripts -->
    <script>
        feather.replace()
    </script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>

<!-- END OF REPLACEMENT BLOCK -->